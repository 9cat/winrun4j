<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
	<head>
		<title>WinRun4J</title>
		<link rel="shortcut icon" href="http://winrun4j.sourceforge.net/favicon.ico" type="image/vnd.microsoft.icon"/>
		<link rel="stylesheet" href="style.css" type="text/css"/>
		<meta name="description" content="Configurable java launcher for windows"/>
		<meta name="keywords" content="java, launcher, windows, icon, splash, screen, memory, open source"/>
		<meta http-equiv="pragma" content="no-cache"/>
	</head>
	<body>

	<div id="heading">
		<div class="title"><img src="WinRun4J.gif">WinRun4j</div>
		<div class="subtitle">Configurable Java Launcher for Windows</div>
	</div>
	
	<div class="content">
		<div class="section">
			<div class="section-title">About</div>
			<div class="section-content">
				WinRun4j is a java launcher for windows. It is an alternative to javaw.exe and provides the following benefits:
				<ul>
						<li>Uses an INI file for specifying classpath, main class, vm args, program args.</li>
						<li>Custom executable name that appears in task manager.</li>
						<li>Additional JVM args for more flexible memory use.</li>
						<li>Built-in icon replacer for custom icon.</li>
						<li>Pre-JVM splash screen with auto-hide.</li>
						<li>DDE implementation for file assocations.</li>
						<li>Windows NT Service wrapper.</li>
						<li>Windows EventLog API</li> 
						<li>Console version</li>
						<li>JNI library for INI access, splash screen, logger, registry, shell.</li>
				</ul>
				<p>
					WinRun4J is licensed under the <a href="http://www.eclipse.org/legal/cpl-v10.html">Common Public License (CPL)</a>.
				</p>
			</div>
		</div>
		<div class="section">
			<div class="section-title">Download</div>
			<div class="section-content">
				The latest <a href="https://sourceforge.net/project/showfiles.php?group_id=195634">download</a> is available from the Project Page.
			</div>
		</div>
		<div class="section">
			<div class="section-title">Usage</div>
			<div class="section-content">
				The launcher is designed to be used as follows:
				<ol>
					<li>Copy WinRun4J.exe to [YourApp].exe</li>
					<li>Create [YourApp].ini (in the same directory)</li>
					<li>Customize [YourApp].ini (see the table below for information)</li>
					<li>Create [YourApp].ico (in the same directory)</li>
					<li>Run [YourApp].exe --WinRun4J:SetIcon (this will inject your icon into the executable).</li>
					<li>Launch [YourApp].exe</li>
				</ol>
				The INI file accepts the following settings:
				<table>
					<tr><th>Key</th><th>Description</th></tr>
					<tr>
						<td>working.directory</td>
						<td>This will be the current directory for the app. It can be relative to your executable.</td>
					</tr>
					<tr>
						<td>classpath.1, classpath.2, ..., classpath.n</td>
						<td>Classpath entries. These will be relative to the working directory above. They can be wildcards (eg. *.jar)</td>
					</tr>
					<tr>
						<td>main.class</td>
						<td>This is the java class that will be run</td>
					</tr>
					<tr>
						<td>vmarg.1, vmarg.2, ..., vmarg.n</td>
						<td>Java VM args. These will be passed on to the VM.</td>
					</tr>
					<tr>
						<td>vm.version.max</td>
						<td>The maximum allowed version (1.0, 1.1, 1.2, 1.3, 1.4, 1.5).</td>
					</tr>
					<tr>
						<td>vm.version.min</td>
						<td>The minimum allowed version (1.0, 1.1, 1.2, 1.3, 1.4, 1.5).</td>
					</tr>
					<tr>
						<td>vm.version</td>
						<td>Specify an exact version to use (eg. 1.5.0_07).</td>
					</tr>
					<tr>
						<td>vm.location</td>
						<td>Specify the location of the JVM dll you want to use. This is useful when you package
						    your own JRE with your app.</td>
					</tr>
					<tr>
						<td>vm.heapsize.max.percent</td>
						<td>Specify
a proportion of the available physical memory to use (ie. relates to
-Xmx arg). For example, vm.heapsize.max.percent=75. Note that this will
use the maximum memory possible.</td>
					</tr>
					<tr>
						<td>vm.heapsize.min.percent</td>
						<td>Specify a proportion of the available physical memory to use as the minimum starting heap size (ie. relates to -Xms arg).</td>
					</tr>
					<tr>
						<td>vm.heapsize.preferred</td>
						<td>Specify
a preferred amount (in MB) for the heap size (ie. relates to -Xmx arg).
If this amount is not available it will use the maximum amount possible
given the physical memory available.</td>
					</tr>
					<tr>
						<td>arg.1, arg.2, ..., arg.n</td>
						<td>Program arguments. These will be sent before any command line arguments.</td>
					</tr>
					<tr>
						<td>log</td>
						<td>Standard out and error streams will be redirected to this file (including launcher messages).</td>
					</tr>
					<tr>
						<td>log.level</td>
						<td>Specify the logging level. One of "info", "warning", "error", "none". Default is "error".</td>
					</tr>
					<tr>
						<td>splash.image</td>
						<td>The name of the splash image file to display (This can be gif, jpg or bmp).
						This will auto-hide itself when it detects the first application window.</td>
					</tr>
					<tr>
						<td>splash.autohide</td>
						<td>A flag to disable the splash screen autohide feature ("true").</td>
					</tr>
					<tr>
						<td>dde.enabled</td>
						<td>This flag needs to be set to "true" to enable DDE.</td>
					</tr>
					<tr>
						<td>dde.class</td>
						<td>Optional flag to send execute commands to your class.</td>
					</tr>
					<tr>
						<td>dde.server.name, dde.topic, dde.window.class</td>
						<td>Override the DDE server name, topic and window class.</td>
					</tr>
					<tr>
						<td>service.class</td>
						<td>This is the java class that will be run (for a service)</td>
					</tr>
					<tr>
						<td>service.id</td>
						<td>This is the ID of the service (used for registration)</td>
					</tr>
				</table>
			</div>
		</div>
		<div class="section">
			<div class="section-title">JNI Library</div>
			<div class="section-content">
				The javadoc for the JNI library can be found <a href="http://winrun4j.sourceforge.net/javadoc/index.html">here</a>.
			</div>
		</div>
		<div class="section">
			<div class="section-title">Examples</div>
			<div class="section-content">
				An example INI file (included in the download) is:
				<pre>
classpath.1=*.jar
main.class=org.boris.winrun4j.WinRunTest
</pre>
				
				An example INI file to run eclipse is:
<pre>
working.directory=.
main.class=org.eclipse.equinox.launcher.Main
classpath.1=plugins\org.eclipse.equinox.launcher*
arg.1=-showsplash				
vm.heapsize.percent=80
</pre>
			</div>
		</div>
		<div class="section"/>
			<div class="section-title">Eclipse DDE Example</div>
			<div class="section-content">
				<p>
					The download includes an alternative launcher for Eclipse that enables DDE. This allows
					the user to double-click on a (eg.) java file in Windows explorer and have the file
					open in the currently opened workspace.
				</p>
				<p>
					To setup this example:
					<ol>
						<li>In your eclipse directory rename eclipse.exe to eclipse.exe.old and rename eclipse.ini to eclipse.ini.old.</li>
						<li>Copy WinRun4J.exe, EcliseDDE.jar, eclipse.ico and eclipse.ini from to downloaded zip file to your eclipse directory.</li>
						<li>Rename WinRun4J.exe to eclipse.exe.</li>
						<li>Run eclipse.exe --WinRun4J:SetIcon. This will change the exectable icon to the eclipse icon.</li>
						<li>Run eclipse.exe --WinRun4J:RegisterFileAssocations. This will register java files to be associated with eclipse.</li>
					</ol>
					You should now be able to double-click on java files in Windows.
				</p>
				<p>
					The following shows the INI file setup:<br/>
<pre>
working.directory=.
main.class=org.boris.winrun4j.EclipseDDE
classpath.1=EclipseDDE.jar
classpath.2=plugins\org.eclipse.equinox.launcher*
vmarg.1=-Xmx512M
vmarg.2=-XX:MaxPermSpace=256M
arg.1=-showsplash
dde.enabled=true
dde.class=org.boris.winrun4j.EclipseDDE

[FileAssociations]
file.1.extension=.java
file.1.name=EclipseJavaFile
file.1.description=Java Source File
</pre>
			</div>
		</div>
		<div class="section"/>
			<div class="section-title">Service Example</div>
			<div class="section-content">
				<p>
					The download contains a simple example of a windows service. Its only function is to
					log to the Windows Event Log every five minutes. To run the example:
					<ol>
						<li>Create a test directory C:/test.</li>
						<li>Copy WinRun4Jc.exe to C:/test and rename to service.exe.</li>
						<li>Copy service.ini to C:/test.</li>
						<li>Copy WinRun4JTest.jar to C:/test.</li>
						<li>Run service.exe --WinRun4J:RegisterService. </li>
						<li>To start/stop the service use the control panel services console (The service name will be "WinRun4J Test Service")</li>
						<li>To unregister run service.exe --WinRun4J:UnregisterService.</li>
					</ol>
				</p>
				<p>
					The following shows the included example of a basic Service implementation.<br/>
<pre>
package org.boris.winrun4j.test;

import org.boris.winrun4j.*;

public class ServiceTest implements Service {
    private int returnCode = 0;
    private boolean shutdown = false;
    
    public int doRequest(int request) throws ServiceException {
        switch(request) {
        case SERVICE_CONTROL_SHUTDOWN:
        case SERVICE_CONTROL_STOP:
            shutdown = true;
            break;
        }
        return 0;
    }

    public int getControlsAccepted() {
        return SERVICE_ACCEPT_SHUTDOWN | SERVICE_ACCEPT_STOP;
    }

    public String getName() {
        return "WinRun4J Test Service";
    }

    public String getDescription() {
        return "An example service using WinRun4J.";
    }

    public int main(String[] args) throws ServiceException {
        int count = 0;
        while(!shutdown) {
            try {
                Thread.sleep(60000);
            } catch (InterruptedException e) {
            }
            
            if(++count % 5 == 0) 
                EventLog.report("WinRun4J Test Service", EventLog.INFORMATION, "Ping");
        }
        
        return returnCode;
    }
}
</pre>
		The INI file for this service looks like this:
<pre>
service.class=org.boris.winrun4j.test.ServiceTest
service.id=ServiceTest
classpath.1=*.jar

vmarg.1=-Xdebug
vmarg.2=-Xnoagent
vmarg.3=-Xrunjdwp:transport=dt_socket,address=8787,server=y,suspend=n
</pre>
			</div>
		</div>
		<div class="section">
			<div class="section-title">Change History</div>
			<div class="section-content">
				V0.1.4
				<ul>
					<li>More fixes for DDE execution on startup.</li>
					<li>Added support for IBM JRE.</li>
				</ul>
				V0.1.3
				<ul>
					<li>Fixes for DDE execution on startup.</li>
				</ul>
				V0.1.2
				<ul>
					<li>Improvements to examples.</li>
					<li>Experimental 64bit build.</li>
					<li>Fix to CPP source files in package.</li>
				</ul>
				V0.1.1
				<ul>
					<li>Fixed bug in console logger.</li>
				</ul>
				V0.1.0
				<ul>
					<li>Added DDE for file assocations (with Eclipse java file association example).</li>
					<li>Added Service wrapper.</li>
					<li>Added Event Log API.</li>
					<li>Added Registry API.</li>
					<li>Reduced EXE size (using <a href="http://wcrt.sourceforge.net">wcrt</a>).</li>
					<li>Added console version.</li>
					<li>Environment variables can be used in INI file (eg. %TEMP%).</li>
					<li>Fix for "." in classpath</li>
					<li>Improved classpath handling with nested wildcards<li>
					<li>Flag to disable splash screen autohide</li>
				</ul>
				V0.0.5
				<ul>
					<li>Added vm.location key.</li>
				</ul>
				V0.0.4
				<ul>
					<li>Fixes splash screen window not being destroyed.</li>
				</ul>
				V0.0.3
				<ul>
					<li>Added JNI access to INI file contents.</li>
					<li>Added splash screen with auto-hide.</li>
					<li>Added JNI access to the splash screen.</li>
				</ul>
				V0.0.2
				<ul>
					<li>Added VM version arguments to allow specification of minimum version, maximum version or exact version.</li>
					<li>Add VM proportional heap size argument.</li>
					<li>Added logging level.</li>
					<li>Improved icon changer (no rename required).</li>
				</ul>
				V0.0.1
				<ul>
					<li>Initial release.</li>
				</ul>
			</div>
		</div>
	</div>
	<div id="footer">
		<p>
			<a href="http://sourceforge.net"><img src="http://sflogo.sourceforge.net/sflogo.php?group_id=195634&amp;type=1" width="88" height="31" border="0" alt="SourceForge.net Logo" /></a>
		</p>
	</div>
</body>
</html>