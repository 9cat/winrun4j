<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head>
        <title>XLL4J - Excel Addin Framework for Java</title>
        <link rel="shortcut icon" href="favicon.ico" type="image/vnd.microsoft.icon">
        <link rel="stylesheet" href="style.css" type="text/css" />
        <meta name="description" content="Excel Addin Framework for Java"/>
        <meta name="keywords" content="java, excel, addin, xll, xloper"/>
        <meta http-equiv="pragma" content="no-cache"/>    
    </head>

    <body>

    <div id="heading">
        <div class="title">XLL4J</div>
        <div class="subtitle">Excel Addin Framework for Java</div>
    </div>
    
    <div class="content">
        <div class="section">
            <div class="section-title">About</div>
            <div class="section-content">
                XLL4J is a framework for developing Microsoft Excel addins (XLLs) in Java.
                It provides a mechanism for implementing Excel functions in Java and has the 
                following features:
                <ul>
                <li>Easy Java VM management via INI file (refer to table below for details).</li>
                <li>Two APIs; one low-level and one reflection based for easy implementation.</li>
                <li>Built-in CSV addin for accessing CSV from filesystem or network.</li>
                </ul> 
                XLL4J is currently alpha quality and has the following limitations:
                <ul>
                <li>Only one instance of the same Java VM version can be run at one time. This is
                a Sun VM limitation. A workaround is currently being worked on.</li>
                <li>There are lots of bugs...</li>
                </ul>
                ExcelAddin4J is licensed under the <a href="http://www.eclipse.org/legal/cpl-v10.html">Common Public License (CPL)</a>.
            </div>
        </div>
        <div class="section">
            <div class="section-title">Download</div>
            <div class="section-content">
                The latest <a href="http://sourceforge.net/project/showfiles.php?group_id=198992">download</a> is available from the Project Page.
            </div>
        </div>
        <div class="section">
            <div class="section-title">Usage</div>
            <div class="section-content">
                The steps for implementing an addin are as follows:
                <ol>
                <li>Copy XLL4J.xll to MyAddin.xll</li>
                <li>Create MyAddin.ini and customize using options below.</li>
                <li>Implement org.excel4.Addin interface (or use ReflectAddin base class).</li>
                <li>You will then be able to load the xll in excel. Note that
                    for there will be a builtin function called MyAddin_GetLastError 
                    that provides some diagnostics.</li>
                </ol>
                The INI file accepts the following settings:
                <table>
                    <tr><th>Key</th><th>Description</th></tr>
                    <tr>
                        <td>addin.class</td>
                        <td>This is the java addin class that implements org.excel4j.Addin</td>
                    </tr>
                    <tr>
                        <td>working.directory</td>
                        <td>This will be the current directory for the app. It can be relative to your addin.</td>
                    </tr>
                    <tr>
                        <td>classpath.1, classpath.2, ..., classpath.n</td>
                        <td>Classpath entries. These will be relative to the working directory above. They can be wildcards (eg. *.jar)</td>
                    </tr>
                    <tr>
                        <td>vmarg.1, vmarg.2, ..., vmarg.n</td>
                        <td>Java VM args. These will be passed on to the VM.</td>
                    </tr>
                    <tr>
                        <td>vm.version.max</td>
                        <td>The maximum allowed version (1.0, 1.1, 1.2, 1.3, 1.4, 1.5).</td>
                    </tr>
                    <tr>
                        <td>vm.version.min</td>
                        <td>The minimum allowed version (1.0, 1.1, 1.2, 1.3, 1.4, 1.5).</td>
                    </tr>
                    <tr>
                        <td>vm.version</td>
                        <td>Specify an exact version to use (eg. 1.5.0_07).</td>
                    </tr>
                    <tr>
                        <td>vm.location</td>
                        <td>Specify the location of the JVM dll you want to use. This is useful when you package
                            your own JRE with your app.</td>
                    </tr>
                    <tr>
                        <td>vm.heapsize.max.percent</td>
                        <td>Specify
a proportion of the available physical memory to use (ie. relates to
-Xmx arg). For example, vm.heapsize.max.percent=75. Note that this will
use the maximum memory possible.</td>
                    </tr>
                    <tr>
                        <td>vm.heapsize.min.percent</td>
                        <td>Specify a proportion of the available physical memory to use as the minimum starting heap size (ie. relates to -Xms arg).</td>
                    </tr>
                    <tr>
                        <td>vm.heapsize.preferred</td>
                        <td>Specify
a preferred amount (in MB) for the heap size (ie. relates to -Xmx arg).
If this amount is not available it will use the maximum amount possible
given the physical memory available.</td>
                    </tr>
                    <tr>
                        <td>log</td>
                        <td>Standard out and error streams will be redirected to this file (including launcher messages).</td>
                    </tr>
                    <tr>
                        <td>log.level</td>
                        <td>Specify the logging level. One of "info", "warning", "error", "none". Default is "error".</td>
                    </tr>
                </table>
            </div>
        </div>
        <div class="section">
            <div class="section-title">JNI Library</div>
            <div class="section-content">
                The javadoc for the JNI library can be found <a href="http://xll4j.sourceforge.net/javadoc/index.html">here</a>.
            </div>
        </div>
        <div class="section">
            <div class="section-title">Example - Hello World</div>
            <div class="section-content">
            The library provides a convenient (reflection-based) wrapper for an addin. So a basic hello
            world addin would look like:
<pre>
package org.excel4j.test;

import org.excel4j.reflect.ReflectAddin;


/**
 * A very basic excel addin.
 */
public class Example1 extends ReflectAddin 
{
    public String MyFunc() {
        return "Hello World!";
    }
}
</pre>
            The corresponding INI file would look like:
<pre>
classpath.1=Example1.jar
addin.class=org.excel4j.test.Example1
</pre>
            </div>
        </div>
        The excel sheet would then look like this:<br/>
        <img src="example1.jpg" border="0"/>
        </div>
        <div class="section">
            <div class="section-title">Example - Working With Arrays</div>
            <div class="section-content">
            The reflection framework can perform conversion from references to arrays:    
<pre>
package org.excel4j.test;

import org.excel4j.reflect.ReflectAddin;

/**
 * An example using arrays.
 */
public class Example2 extends ReflectAddin
{
    public double MyExampleSum(double[][] vals) {
        double result = 0;

        for(int i = 0; i < vals.length; i++) {
            for(int j = 0; j < vals[i].length; j++) {
                result += vals[i][j];
            }
        }

        return result;
    }
}
</pre>
		The excel sheet would then look like this:<br/>
		<img src="example2.jpg" border="0"/>
		</div>
        <div class="section">
            <div class="section-title">Example - Working With Objects</div>
            <div class="section-content">
            The reflection framework allows you to pass around Java objects to and from functions.
            This is achieved via ID references (strings) and a cache. An example of this is:
<pre>
package org.excel4j.test;

import org.excel4j.reflect.ReflectAddin;

/**
 * An example using objects.
 */
public class Example3 extends ReflectAddin 
{
    public static class Test {
        String a, b;
    }
    
    public Test CreateTest() {
        Test a = new Test();
        a.a = "Hello";
        a.b = "World!";
        return a;
    }
    
    public String[][] DumpTest(Test t) {
        return new String[][] {
                { "A", t.a },
                { "B", t.b }};
    }
}
</pre>
		The excel sheet would then look like this:<br/>
		<img src="example3.jpg" border="0"/>
            </div>
        </div>
    </div>
        <div class="section">
            <div class="section-title">Change History</div>
            <div class="section-content">
                V0.0.2
                <ul>
                    <li>Improved classpath handling.</li>
                    <li>Bug fixes.</li>
                </ul>
                V0.0.1
                <ul>
                    <li>Initial release.</li>
                </ul>
            </div>
        </div>
    <div id="footer">
        <p>
            <a href="http://sourceforge.net"><img src="http://sflogo.sourceforge.net/sflogo.php?group_id=195634&amp;type=1" width="88" height="31" border="0" alt="SourceForge.net Logo" /></a>
        </p>
    </div>
</body>
</html>